=======================================
Attack-step with identity Pre-condition
=======================================

category Test {
    asset TestAsset {
        | onePrecon
            <- a
        | multiplePrecon
            <- a, b
    }
}

---------------------------------------

(source_file
    (category_declaration
        id: (identity)
        assets: ((asset
                    id: (identity)
                    steps: ((attack_step
                                id: (identity)
                                preconditions: ((asset_expr (identity))))
                            (attack_step
                                id: (identity)
                                preconditions: ((asset_expr (identity))
                                                (asset_expr (identity)))))))))

-----------------------------------------------------------------
Attack-step with collection on simple identities in Pre-condition
-----------------------------------------------------------------

category Test {
    asset TestAsset {
        | oneCollect
            <- a.b
        | multipleCollect
            <- a.b.c
    }
}

-----------------------------------------------------------------

(source_file
    (category_declaration
        id: (identity)
        assets: ((asset
                    id: (identity)
                    steps: ((attack_step
                                id: (identity)
                                preconditions: ((asset_expr 
                                                    (asset_expr_collect 
                                                        parent: (identity)
                                                        child:  (identity)))))
                            (attack_step
                                id: (identity)
                                preconditions: ((asset_expr 
                                                    (asset_expr_collect 
                                                        parent: (identity)
                                                        child:  (asset_expr_collect 
                                                                    parent: (identity)
                                                                    child:  (identity)))))))))))

===============================================
Attack-step with set operators in Pre-condition
===============================================

category Test {
    asset TestAsset {
        | union
            <- a \/ b
        | intersect
            <- a /\ b
        | difference
            <- a - b
    }
}

-----------------------------------------------

(source_file
    (category_declaration
        id: (identity)
        assets: ((asset
                    id: (identity)
                    steps: ((attack_step
                                id: (identity)
                                preconditions: ((asset_expr 
                                                    (asset_expr_setop
                                                        left: (asset_expr (identity))
                                                        right: (asset_expr (identity))))))
                            (attack_step
                                id: (identity)
                                preconditions: ((asset_expr 
                                                    (asset_expr_setop
                                                        left: (asset_expr (identity))
                                                        right: (asset_expr (identity))))))
                            (attack_step
                                id: (identity)
                                preconditions: ((asset_expr 
                                                    (asset_expr_setop
                                                        left: (asset_expr (identity))
                                                        right: (asset_expr (identity)))))))))))
