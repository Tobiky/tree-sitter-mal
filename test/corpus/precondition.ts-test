=======================================
Attack-step with identity Pre-condition
=======================================

category Test {
    asset TestAsset {
        | onePrecon
            <- a
        | multiplePrecon
            <- a, b
    }
}

---------------------------------------

(source_file
  (declaration
    (category_declaration
      id: (identity)
      assets: (asset
        id: (identity)
        body: (attack_step
          id: (identity)
          precondition: (precondition
            condition: (asset_expr_primary
              (identity))))
        body: (attack_step
          id: (identity)
          precondition: (precondition
            condition: (asset_expr_primary
              (identity))
            condition: (asset_expr_primary
              (identity))))))))

============================================================
Attack-step with asset expression operators in Pre-condition
============================================================

category Test {
    asset TestAsset {
        | binops
            <- (a),
                a \/ b,
                a /\ b,
                a - b,
                a.b,
                a.b.c,
                a().b,
                a*.b,
                a[Type],
                a[TypeA][TypeB]
    }
}

-------------------------------------------------------------

(source_file
  (category_declaration
    id: (identity)
    assets: ((asset
      id: (identity)
      body: ((attack_step
        id: (identity)
        preconditions: ((asset_expr_atom
          (identity))
        (asset_expr_binop
          left: (asset_expr_atom
            (identity))
          right: (asset_expr_atom
            (identity)))
        (asset_expr_binop
          left: (asset_expr_atom
            (identity))
          right: (asset_expr_atom
            (identity)))
        (asset_expr_binop
          left: (asset_expr_atom
            (identity))
          right: (asset_expr_atom
            (identity)))
        (asset_expr_binop
          left: (asset_expr_atom
            (identity))
          right: (asset_expr_atom
            (identity)))
        (asset_expr_binop
          left: (asset_expr_atom
            (identity))
          right: (asset_expr_binop
            left: (asset_expr_atom
              (identity))
            right: (asset_expr_atom
              (identity))))
        (asset_expr_binop
          left: (asset_expr_atom
            (identity))
          right: (asset_expr_atom
            (identity)))
        (asset_expr_binop
          left: (asset_expr_atom
            (identity))
          right: (asset_expr_atom
            (identity)))
        (asset_expr_type
          type_id: (identity)
          expr: (asset_expr_atom
            (identity)))
        (asset_expr_type
          type_id: (identity)
          expr: (asset_expr_type
            type_id: (identity)
            expr: (asset_expr_atom
              (identity))))))))
