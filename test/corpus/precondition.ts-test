=======================================
Attack-step with identity Pre-condition
=======================================

category Test {
    asset TestAsset {
        | onePrecon
            <- a
        | multiplePrecon
            <- a, b
    }
}

---------------------------------------

(source_file
    (category_declaration
        id: (identity)
        assets: ((asset
                    id: (identity)
                    steps: ((attack_step
                                id: (identity)
                                preconditions: ((asset_expr (identity))))
                            (attack_step
                                id: (identity)
                                preconditions: ((asset_expr (identity))
                                                (asset_expr (identity)))))))))

-----------------------------------------------------------------
Attack-step with collection on simple identities in Pre-condition
-----------------------------------------------------------------

category Test {
    asset TestAsset {
        | oneCollect
            <- a.b
        | multipleCollect
            <- a.b.c
    }
}

-----------------------------------------------------------------

(source_file
    (category_declaration
        id: (identity)
        assets: ((asset
                    id: (identity)
                    steps: ((attack_step
                                id: (identity)
                                preconditions: ((asset_expr 
                                                    (asset_expr_collect 
                                                        parent: (identity)
                                                        child:  (identity)))))
                            (attack_step
                                id: (identity)
                                preconditions: ((asset_expr 
                                                    (asset_expr_collect 
                                                        parent: (identity)
                                                        child:  (asset_expr_collect 
                                                                    parent: (identity)
                                                                    child:  (identity)))))))))))

===============================================
Attack-step with set operators in Pre-condition
===============================================

category Test {
    asset TestAsset {
        | union
            <- a \/ b,
               a /\ b,
               a - b
    }
}

-----------------------------------------------

(source_file
    (category_declaration
        id: (identity)
        assets: ((asset
                    id: (identity)
                    steps: ((attack_step
                                id: (identity)
                                preconditions: ((asset_expr_binop
                                                     left: (asset_expr_atom (identity))
                                                     right: (asset_expr_atom (identity)))
                                                (asset_expr_binop
                                                     left: (asset_expr_atom (identity))
                                                     right: (asset_expr_atom (identity)))
                                                (asset_expr_binop
                                                     left: (asset_expr_atom (identity))
                                                     right: (asset_expr_atom (identity))))))))))

=====================================================================================================================
Attack-step with parenthesis, variable substitution, transitive operator, and type asset expressions in Pre-condition
=====================================================================================================================

category Test {
    asset TestAsset {
        | parenthesis
            <- (a),
                a().b,
                a[Type],
                a[TypeA][TypeB],
                a*.b,
    }
}

---------------------------------------------------------------------------------------------------------------------

(source_file
    (category_declaration
        id: (identity)
        assets: ((asset
                    id: (identity)
                    steps: ((attack_step
                                id: (identity)
                                preconditions: ((asset_expr_atom (identity))
                                                (asset_expr_binop
                                                    left: (asset_expr_atom (identity))
                                                    right: (asset_expr_atom (identity)))
                                                (asset_expr_binop
                                                    left: (asset_expr_atom (identity))
                                                    right: (asset_expr_atom (identity)))
                                                (asset_expr_binop
                                                    left: (asset_expr_atom (identity))
                                                    right: (asset_expr_binop
                                                                left: (asset_expr_atom (identity))
                                                                right: (asset_expr_atom (identity))))
                                                (asset_expr_binop
                                                    left: (asset_expr_atom (identity))
                                                    right: (asset_expr_atom (identity))))))))))
