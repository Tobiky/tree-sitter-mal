=======================================
Attack-step with identity Pre-condition
=======================================

category Test {
    asset TestAsset {
        | onePrecon
            <- a
        | multiplePrecon
            <- a, b
    }
}

---------------------------------------

(source_file
  (declaration
    (category_declaration
      id: (identity)
      assets: (asset
        id: (identity)
        body: (attack_step
          id: (identity)
          preconditions: (preconditions
            condition: (asset_expr_primary
              (identity))))
        body: (attack_step
          id: (identity)
          preconditions: (preconditions
            condition: (asset_expr_primary
              (identity))
            condition: (asset_expr_primary
              (identity))))))))

============================================================
Attack-step with asset expression operators in Pre-condition
============================================================

category Test {
    asset TestAsset {
        | binops
            <- (a),
                a \/ b,
                a /\ b,
                a - b,
                a.b,
                a.b.c,
                a().b,
                a*.b,
                a[Type],
                a[TypeA][TypeB]
    }
}

-------------------------------------------------------------

(source_file
  (declaration
    (category_declaration
      id: (identity)
      assets: (asset
        id: (identity)
        body: (attack_step
          id: (identity)
          preconditions: (preconditions
            condition: (asset_expr_primary
              (identity))
            condition: (asset_expr_binop
              left: (asset_expr_primary
                (identity))
              right: (asset_expr_primary
                (identity)))
            condition: (asset_expr_binop
              left: (asset_expr_primary
                (identity))
              right: (asset_expr_primary
                (identity)))
            condition: (asset_expr_binop
              left: (asset_expr_primary
                (identity))
              right: (asset_expr_primary
                (identity)))
            condition: (asset_expr_binop
              left: (asset_expr_primary
                (identity))
              right: (asset_expr_primary
                (identity)))
            condition: (asset_expr_binop
              left: (asset_expr_binop
                left: (asset_expr_primary
                  (identity))
                right: (asset_expr_primary
                  (identity)))
              right: (asset_expr_primary
                (identity)))
            condition: (asset_expr_binop
              left: (asset_expr_primary
                (asset_variable_substitution
                  id: (identity)))
              right: (asset_expr_primary
                (identity)))
            condition: (asset_expr_binop
              left: (asset_expr_unop
                expression: (asset_expr_primary
                  (identity)))
              right: (asset_expr_primary
                (identity)))
            condition: (asset_expr_type
              expression: (asset_expr_primary
                (identity))
              type_id: (identity))
            condition: (asset_expr_type
              expression: (asset_expr_type
                expression: (asset_expr_primary
                  (identity))
                type_id: (identity))
              type_id: (identity))))))))
