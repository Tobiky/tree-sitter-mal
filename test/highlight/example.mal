/*
 * Copyright 2020-2022 Foreseeti AB <https://foreseeti.com>
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     https://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
#id: "org.mal-lang.examplelang"
// <- operator
 // <- constant
//   ^^^^^^^^^^^^^^^^^^^^^^^^^^ string
#version: "1.0.0"
// <- operator
 // <- constant
//        ^^^^^^^ string

category System {
// <- keyword
//              ^ punctuation.bracket
  asset Network {
    // <- keyword
    //          ^ punctuation.bracket
    | access
    // <- operator
      -> hosts.connect
    // ^ operator
    //        ^ operator
  }
  // <- punctuation.bracket

  asset Host {
    // <- keyword
    //       ^ punctuation.bracket
    | connect
    // <- operator
      -> access
    // ^ operator
    | authenticate
    // <- operator
      -> access
    // ^ operator
    | guessPassword
    // <- operator
      -> guessedPassword
    // ^ operator
    | guessedPassword [Exponential(0.02)]
    // <- operator
    //                ^ punctuation.bracket
    //                 ^^^^^^^^^^^ function.builtin
    //                            ^ punctuation.bracket
    //                             ^^^^ number
    //                                 ^^ punctuation.bracket
      -> authenticate
    // ^ operator
    & access
    // <- operator
  }
  // <- punctuation.bracket

  asset User {
    // <- keyword
    //       ^ punctuation.bracket
    | attemptPhishing
    // <- operator
      -> phish
    // ^ operator
    | phish [Exponential(0.1)]
    // <- operator
    //      ^ punctuation.bracket
    //       ^^^^^^^^^^^ function.builtin
    //                  ^ punctuation.bracket
    //                   ^^^ number
    //                      ^^ punctuation.bracket
      -> passwords.obtain
    // ^ operator
    //            ^ operator
  }
  // <- punctuation.bracket

  asset Password {
    // <- keyword
    //           ^ punctuation.bracket
    | obtain
    // <- operator
      -> host.authenticate
    // ^ operator
    //       ^ operator
  }
  // <- punctuation.bracket
}
// <- punctuation.bracket

associations {
  // <- keyword
  //         ^ punctuation.bracket
  Network [networks] * <-- NetworkAccess --> * [hosts] Host
  // <- type
  //      ^ punctuation.bracket
  //       ^^^^^^^^ property
  //               ^ punctuation.bracket
  //                 ^ number
  //                   ^^^ operator
  //                                     ^^^ operator
  //                                         ^ number
  //                                           ^ punctuation.bracket
  //                                            ^^^^^ property
  //                                                 ^ punctuation.bracket
  //                                                   ^^^^ type
  Host [host] 1 <-- Credentials --> * [passwords] Password
  // <- type
  //   ^ punctuation.bracket
  //    ^^^^ property
  //        ^ punctuation.bracket
  //          ^ number
  //            ^^^ operator
  //                            ^^^ operator
  //                                ^ number
  //                                  ^ punctuation.bracket
  //                                   ^^^^^^^^^ property
  //                                            ^ punctuation.bracket
  //                                              ^^^^^^^^ type
  User [user] 1 <-- Credentials --> * [passwords] Password
  // <- type
  //   ^ punctuation.bracket
  //    ^^^^ property
  //        ^ punctuation.bracket
  //          ^ number
  //            ^^^ operator
  //                            ^^^ operator
  //                                ^ number
  //                                  ^ punctuation.bracket
  //                                   ^^^^^^^^^ property
  //                                            ^ punctuation.bracket
  //                                              ^^^^^^^^ type
}
// <- punctuation.bracket
